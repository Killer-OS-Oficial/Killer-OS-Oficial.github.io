{"hash":"8cdcb24eb6b965aabc424dc02a3705a76aba031a","data":{"markdownPage":{"id":"9939e82a15a61c1343f9631b019f42f9","title":"Squashfs","description":"","date":null,"date_up":"13.08.2020","path":"/wiki/backup/squashfs/","timeToRead":2,"content":"<h1 id=\"copia-de-seguridad-de-squashfs\"><a href=\"#copia-de-seguridad-de-squashfs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Copia de seguridad de Squashfs</h1>\n<h2 id=\"reducir-una-partición-con-mksquashfs\"><a href=\"#reducir-una-partici%C3%B3n-con-mksquashfs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Reducir una partición con mksquashfs</h2>\n<pre class=\"language-bash\"><code class=\"language-bash\">pacman -S squashfs-tools arch-install-scripts</code></pre>\n<p>Observamos las particiones del disco.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">lsblk</code></pre>\n<p>Monte para leer root, arranque (inicio) y cree una imagen, comprima xz.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mount</span> /dev/sda5 -o ro /mnt\n<span class=\"token function\">mount</span> /dev/sda2 -o ro /mnt/boot\n<span class=\"token function\">mount</span> /dev/sda7 -o ro /mnt/home</code></pre>\n<p>Archivado.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">mksquashfs /mnt ~/backup/myarch.sfs -comp xz</code></pre>\n<p>Una excepción: <code>-e /dir/file</code>.</p>\n<p>Lo desmontaremos al finalizar.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">umount</span> -R /mnt</code></pre>\n<h2 id=\"recuperación\"><a href=\"#recuperaci%C3%B3n\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Recuperación</h2>\n<p>Desde un sistema en funcionamiento o Live-usb. Formateamos y montamos una partición dañada o nueva, arrancamos si es necesario, etc.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">mkfs.ext4 -L <span class=\"token string\">\"root\"</span> -U <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>blkid -o value -s UUID /dev/sda5<span class=\"token variable\">)</span></span>\"</span> /dev/sda5\nmkfs.ext2 -L <span class=\"token string\">\"boot\"</span> -U <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>blkid -o value -s UUID /dev/sda2<span class=\"token variable\">)</span></span>\"</span> /dev/sda2\nmkfs.ext4 -L <span class=\"token string\">\"home\"</span> -U <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>blkid -o value -s UUID /dev/sda7<span class=\"token variable\">)</span></span>\"</span> /dev/sda7\n<span class=\"token function\">mkswap</span> /dev/sda3\n\n<span class=\"token function\">mount</span> /dev/sda5 /mnt\n<span class=\"token function\">mount</span> /dev/sda2 /mnt/boot\n<span class=\"token function\">mount</span> /dev/sda7 /mnt/home</code></pre>\n<p>Desempaquete la imagen comprimida.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">unsquashfs -d /mnt -f ~/backup/myarch.sfs</code></pre>\n<p>Revisemos y desmontemos la partición.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> /mnt\n<span class=\"token function\">umount</span> /dev/sda2\n<span class=\"token function\">umount</span> /dev/sda7\n<span class=\"token function\">umount</span> /dev/sda5</code></pre>\n<p>Monte la partición raíz (dev/sda5), arranque, etc., si es necesario.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mount</span> /dev/sda5 /mnt\n<span class=\"token function\">mount</span> /dev/sda2 /mnt/boot\n<span class=\"token function\">mount</span> /dev/sda7 /mnt/home\n<span class=\"token function\">swapon</span> /dev/sda3</code></pre>\n<p>Editar / generar si es necesario <code>/etc/fstab</code>, <code>/etc/mkinitcpio.conf</code>.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">rm</span> /mnt/etc/fstab\ngenfstab -pU /mnt <span class=\"token operator\">></span> /mnt/etc/fstab</code></pre>\n<p>Chroot en el nuevo sistema.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">arch-chroot /mnt /bin/zsh</code></pre>\n<p>o <code>chroot /mnt /bin/bash</code> Le gusta a Debian.</p>\n<p>Creamos imágenes initramfs.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">mkinitcpio -p linux</code></pre>\n<p>Configurando claves de pacman.</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">pacman-key --init\npacman-key --populate archlinux</code></pre>\n<p>Actualizar el menú del cargador de arranque es de mala educación, os-prober (para buscar otro sistema operativo).</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">pacman -S os-prober\ngrub-install /dev/sda\n<span class=\"token function\">grub-mkconfig</span> -o /boot/grub/grub.cfg</code></pre>\n<p>¡Salga de <strong>chroot</strong> , desmonte las particiones y reinicie el sistema restaurado!</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">umount</span> /mnt/boot\n<span class=\"token function\">umount</span> /mnt/home\n<span class=\"token function\">umount</span> /mnt\n<span class=\"token function\">reboot</span></code></pre>\n<h2 id=\"montar-una-imagen\"><a href=\"#montar-una-imagen\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Montar una imagen</h2>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mount</span> ~/backup/myarch.sfs -t squashfs -o loop /mnt</code></pre>\n<p>Ahora puede copiar cualquier archivo <code>cp -p</code> que desee de la imagen.</p>\n<p>No podrá agregar nada de esta manera, para ello tendrá que usar <code>mksquashfs</code> nuevamente.</p>\n","sidebar":"wiki","next":"/wiki/backup/netcat/","prev":"/wiki/backup/timeshift-rsync/","headings":[{"depth":1,"value":"Copia de seguridad de Squashfs","anchor":"#copia-de-seguridad-de-squashfs"},{"depth":2,"value":"Reducir una partición con mksquashfs","anchor":"#reducir-una-partición-con-mksquashfs"},{"depth":2,"value":"Recuperación","anchor":"#recuperación"},{"depth":2,"value":"Montar una imagen","anchor":"#montar-una-imagen"}]},"allMarkdownPage":{"edges":[{"node":{"path":"/wiki/changelog/bspwm-0-3-1/","title":"Bspwm v0.3.1"}},{"node":{"path":"/wiki/changelog/xfce-1-8-0/","title":"Xfce v1.8.0"}},{"node":{"path":"/wiki/changelog/openbox-1-3-0/","title":"Openbox v1.3.0"}},{"node":{"path":"/wiki/changelog/bspwm-0-1-0/","title":"Bspwm v0.1.0"}},{"node":{"path":"/wiki/changelog/xfce-1-6-0/","title":"Xfce v1.6.0"}},{"node":{"path":"/wiki/changelog/openbox-1-2-0/","title":"Openbox v1.2.0"}},{"node":{"path":"/wiki/changelog/i3-1-0-0/","title":"I3 v1.0.0"}},{"node":{"path":"/wiki/changelog/xfce-1-5-0/","title":"Xfce v1.5.0"}},{"node":{"path":"/wiki/changelog/xfce-1-4-0/","title":"Xfce v1.4.0"}},{"node":{"path":"/wiki/changelog/bspwm-0-0-1/","title":"Bspwm v0.0.1"}},{"node":{"path":"/wiki/changelog/xfce-1-3-0/","title":"Xfce v1.3.0"}},{"node":{"path":"/wiki/changelog/openbox-2-1/","title":"Openbox,i3 v2.1"}},{"node":{"path":"/wiki/changelog/xfce-1-2-0/","title":"Xfce v1.2.0"}},{"node":{"path":"/wiki/changelog/xfce-1-1-0/","title":"Xfce v1.1.0"}},{"node":{"path":"/wiki/changelog/openbox-2-2/","title":"Openbox,i3 v2.2"}},{"node":{"path":"/wiki/changelog/openbox-2-0-0/","title":"Openbox,i3 v2.0.0"}},{"node":{"path":"/wiki/changelog/openbox-1-0-0/","title":"Openbox v1.0.0"}},{"node":{"path":"/wiki/changelog/xfce-1-0-0/","title":"Xfce v1.0.0"}},{"node":{"path":"/wiki/changelog/default/","title":"Xfce v1.0.0"}},{"node":{"path":"/wiki/wm/bspwm/","title":"Ctlos Bspwm"}},{"node":{"path":"/wiki/packages/other-pkg/","title":"Доп. программы"}},{"node":{"path":"/wiki/packages/iwd/","title":"Iwd wifi"}},{"node":{"path":"/wiki/other/screencast/","title":"Screencast"}},{"node":{"path":"/wiki/other/notes/","title":"Заметки"}},{"node":{"path":"/wiki/other/grub-uefi/","title":"Grub UEFI"}},{"node":{"path":"/wiki/other/gnupg/","title":"Gnupg"}},{"node":{"path":"/wiki/other/git-start/","title":"Git Start"}},{"node":{"path":"/wiki/other/ctlosiso/","title":"Ctlos iso"}},{"node":{"path":"/wiki/install/pkg-manager/","title":"Менеджеры пакетов"}},{"node":{"path":"/wiki/install/next-install/","title":"После установки"}},{"node":{"path":"/wiki/install/install-ctlos/","title":"Установка Ctlos"}},{"node":{"path":"/wiki/install/ctlos-repo/","title":"Репозиторий ctlos"}},{"node":{"path":"/wiki/config/videocfg/","title":"Видео драйвера"}},{"node":{"path":"/wiki/config/trouble/","title":"Решение проблем"}},{"node":{"path":"/wiki/config/ssh/","title":"Настройка ssh"}},{"node":{"path":"/wiki/config/recomend/","title":"Рекомендации"}},{"node":{"path":"/wiki/config/autologin/","title":"Автологин"}},{"node":{"path":"/wiki/changelog/","title":"Changelog"}},{"node":{"path":"/wiki/backup/netcat/","title":"Netcat, ssh, rsync"}},{"node":{"path":"/wiki/btrfs/btrfs-part2/","title":"Btrfs перенос"}},{"node":{"path":"/wiki/btrfs/btrfs-part1/","title":"Instalación de btrfs"}},{"node":{"path":"/wiki/backup/timeshift-rsync/","title":"Timeshift, rsync"}},{"node":{"path":"/wiki/backup/squashfs/","title":"Squashfs"}},{"node":{"path":"/wiki/whois/","title":"Brevemente sobre Killer-OS Linux"}},{"node":{"path":"/wiki/","title":"Killer-OS Linux Wiki"}}]}},"context":{}}